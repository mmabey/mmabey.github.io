

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Troubles with OpenVPN in Ubuntu 12.04 &mdash; Mike Mabey</title>
  

  
  
    <link rel="shortcut icon" href="../../../_static/favicon.ico"/>
  
  
  

  

  
  
    
      <link rel="search" type="application/opensearchdescription+xml"
            title="Search within Mike Mabey"
            href="../../../_static/opensearch.xml"/>
    

  

  <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/custom.css" type="text/css" />
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Risk Intelligence: Get better at seeing the future without the two Strawberry Nirvanas" href="risk_intelligence.html" />
    <link rel="prev" title="Pydroid at last!" href="../06/pydroid_at_last.html" />

  <link href='https://fonts.googleapis.com/css?family=Lato:400,700,400italic,700italic|Roboto+Slab:400,700|Inconsolata:400,700&subset=latin,cyrillic' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" type="text/css" href="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.0.3/cookieconsent.min.css" />
  <script src="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.0.3/cookieconsent.min.js"></script>
  <script>
      window.addEventListener("load", function(){
          window.cookieconsent.initialise({
              "palette": {
                  "popup": { "background": "#343131" },
                  "button": { "background": "#2980b9" }
              },
              "theme": "classic", "position": "bottom-right",
              "content": { "message": "This website uses cookies." }
          })});
  </script>

  <script src="../../../_static/tag_toggle.js" ></script>

  <!-- Structured article data -->
  <script type="application/ld+json">
    {
      "@context": "http://schema.org",
      "@type": "BlogPosting",
      "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "https://mikemabey.com/blog/2012/05/troubles_with_openvpn.html"
      },
      "headline": "Troubles with OpenVPN in Ubuntu 12.04",
      
      "author": {
        "@type": "Person",
        "name": "Mike Mabey"
      },
      "datePublished": "2012-05-17T00:00:00",
      "dateModified": "2012-05-17T00:00:00",
      "publisher": {
        "@type": "Organization",
        "name": "mikemabey.com",
        "logo": {
          "@type": "ImageObject",
          "url": "https://mikemabey.com/logo.png",
          "width": 395,
          "height": 60
        }
      }
    }
  </script>

  <!-- Structured breadcrumb data for the blog -->
  <script type="application/ld+json">
  {
    "@context": "http://schema.org",
    "@type": "BreadcrumbList",
    "itemListElement": [{
      "@type": "ListItem",
      "position": 1,
      "item": {
        "@id": "https://mikemabey.com/blog",
        "name": "Blog"
      }
    },{
      "@type": "ListItem",
      "position": 2,
      "item": {
        "@id": "https://mikemabey.com/blog/2012",
        "name": "2012"
      }
    },{
      "@type": "ListItem",
      "position": 3,
      "item": {
        "@id": "https://mikemabey.com/blog/2012/05/troubles_with_openvpn.html",
        "name": "Troubles with OpenVPN in Ubuntu 12.04"
      }
    }]
  }
  </script>

  <!-- Structured social profile links -->
  <script type="application/ld+json">
  {
    "@context": "http://schema.org",
    "@type": "Person",
    "name": "Mike Mabey",
    "url": "https://mikemabey.com",
    "sameAs": [
      "https://plus.google.com/+MikeMabey",
      "https://twitter.com/mkmabey",
      "https://www.linkedin.com/pub/michael-mabey/18/a24/a6b/en"
    ]
  }
  </script>

  <!-- Search helper for Google -->
  <script type="application/ld+json">
  {
    "@context": "http://schema.org",
    "@type": "WebSite",
    "url": "https://mikemabey.com/",
    "potentialAction": {
      "@type": "SearchAction",
      "target": "https://mikemabey.com/search.html?q={search_term_string}",
      "query-input": "required name=search_term_string"
    }
  }
  </script>



  
  <script src="../../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

  

  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-59535121-1', 'auto');
    ga('send', 'pageview');

  </script>


  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../../index.html" class="icon icon-home"> Mike Mabey
          

          
          </a>

          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search site" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../index.html">Home</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../classes.html">Classes</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../cse469s19/index.html">CSE 469 Spring 2019</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../cse469s19/index.html">Course Home Page</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../cse469s19/syllabus.html">Syllabus</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../cse469s19/assignments.html">Assignments</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../cse469s19/paper_report.html">Paper Report</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../cse469s19/project.html">Group Project</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../pubs.html">Publications</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../service.html">Service</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../teaching.html">Teaching Experience</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../web.html">Around the Web</a><ul>
<li class="toctree-l2"><a class="reference external" href="https://bitbucket.org/mmabey/">Bitbucket</a></li>
<li class="toctree-l2"><a class="reference external" href="https://github.com/mmabey">GitHub</a></li>
<li class="toctree-l2"><a class="reference external" href="https://pypi.org/user/mmabey/">PyPI</a></li>
<li class="toctree-l2"><a class="reference external" href="https://blog.mikemabey.com">Blog</a></li>
<li class="toctree-l2"><a class="reference external" href="https://twitter.com/mkmabey">Twitter</a></li>
<li class="toctree-l2"><a class="reference external" href="https://www.linkedin.com/pub/michael-mabey/18/a24/a6b/en">LinkedIn</a></li>
<li class="toctree-l2"><a class="reference external" href="http://scholar.google.com/citations?user=kSpLEdsAAAAJ&amp;hl=en">Google Scholar</a></li>
<li class="toctree-l2"><a class="reference external" href="http://sefcom.asu.edu/">SEFCOM Research Lab</a></li>
<li class="toctree-l2"><a class="reference external" href="https://webapp4.asu.edu/directory/person/1353747">ASU Profile</a></li>
<li class="toctree-l2"><a class="reference external" href="https://prezi.com/user/mikemabey/">Prezi</a></li>
<li class="toctree-l2"><a class="reference external" href="http://alternativeto.net/user/mikemabey/">AlternativeTo</a></li>
<li class="toctree-l2"><a class="reference external" href="https://readthedocs.org/profiles/mmabey/">Read the Docs</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="../../index.html">Blog</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../2017/index.html">2017 Entries</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../2017/08/ecryptfs_filenames.html">How eCryptfs Affects Filename Lengths</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../2017/06/goodbye_blogger.html">Goodbye Blogger!</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../2016/index.html">2016 Entries</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../2016/03/using_git_stash_staged_changes.html">Using git-stash without losing staged changes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../2016/02/check_out_old_chromium.html">How to check out an old version of Chromium OS</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../2016/01/n_dimensional_latex.html">Getting “n-dimensional” to look right in LaTeX</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../2015/index.html">2015 Entries</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../2015/01/fixing_repo_init_chromium_os.html">Fixing repo init to check out Chromium OS code</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../2013/index.html">2013 Entries</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../2013/10/last_straw_for_excel.html">The Last Straw for Excel?</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../2013/05/getting_into_developer_mode.html">Getting into Developer Mode on the HP Pavilion 14 Chromebook</a></li>
</ul>
</li>
<li class="toctree-l2 current"><a class="reference internal" href="../index.html">2012 Entries</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../11/downgraded_to_python_2.7.1.html">Downgraded to Python 2.7.1? How did that happen?</a></li>
<li class="toctree-l3"><a class="reference internal" href="../08/the_internet_is_so_awesome.html">The Internet is so awesome (in case you didn’t already know)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../06/debian_on_android.html">Debian on Android and my quest for a full-fledged terminal Python IDE</a></li>
<li class="toctree-l3"><a class="reference internal" href="../06/openvpn-update-fixed.html">OpenVPN Update: Fixed!</a></li>
<li class="toctree-l3"><a class="reference internal" href="../06/pydroid_at_last.html">Pydroid at last!</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Troubles with OpenVPN in Ubuntu 12.04</a></li>
<li class="toctree-l3"><a class="reference internal" href="risk_intelligence.html">Risk Intelligence: Get better at seeing the future without the two Strawberry Nirvanas</a></li>
<li class="toctree-l3"><a class="reference internal" href="first_post.html">First Post</a></li>
</ul>
</li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
      &nbsp;
      <div class="served_by">Served with<br />
        <a href="https://pages.github.com/"><img src="/_static/gh_pages.svg"/></a>
        <a href="https://www.cloudflare.com/"><img src="/_static/cf.png"/></a>
        <div style="display: none;">

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">Mike Mabey</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          <h1 style="margin-bottom: 3px;">/var/log/mike</h1>
<h2 style="margin-bottom: 3px;"><em>Mike’s Blog</em></h2>
<hr style="margin-bottom: 7px; margin-top: 3px;"/>
<div style="float: right;"><a href="/blog/">Back to Blog Index</a></div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="troubles-with-openvpn-in-ubuntu-12-04">
<span id="troubles-with-openvpn-in-ubuntu-12-04"></span><h1>Troubles with OpenVPN in Ubuntu 12.04<a class="headerlink" href="#troubles-with-openvpn-in-ubuntu-12-04" title="Permalink to this headline">¶</a></h1>
<p><strong>Update</strong>: Check out my&nbsp;<a class="reference external" href="../../../../../blog/2012/06/openvpn-update-fixed.md">solution to the problem</a>&nbsp;described below.</p>
<p>Last year at work I set up a VPN using OpenVPN in Ubuntu Server 11.10. There were a number of issues with supporting
the specific topology of the local network I was trying to make accessible that made it tricky to get traffic from a
connected client properly routed in and back. To be upfront, I’m not a Linux guru. I get by with the principles I’ve
learned in the classroom, the tips I’ve been given from more enthusiastic friends and family, and from what I can glean
from forums, help pages, and manual pages, and generally I do alright.</p>
<p>Back to my story. So last year I honestly don’t know what exactly it was that got things to work, which is bad, I know.
At one point I had two other guys helping me while we looked at the traffic going between a client and the VPN server
with Wireshark on both ends. We could see ping packets making it successfully to the server and we could see the
responses generated by the server, but no replies were making it back to the client. Weird. In that case, I finally
figured out that in the different configurations I had tried, at one point I had commented out the bridged interface,
br0, from /etc/network/interfaces. I un-commented those lines, things started working, and I never touched it for fear
of breaking things. Restarting the system kept things going, so it must have been some sort of persistent
configuration.</p>
<p>Fast forward to a couple weeks ago, when my <a class="reference external" href="../../../../../blog/2012/05/risk_intelligence.md">overconfidence</a> and excitement at the
release of Ubuntu 12.04 LTS got the better of me, overpowering my previous fear of breaking the VPN. I think I said to
myself something like the following.  “Well, all the configuration files will carry over, so things can only get better
by running ‘sudo do-release-upgrade’, right? After all, this is a Long-Term Support release, so it’s nice and stable.”</p>
<p>Wrong. Things broke. So far, I’ve overcome one hurdle, but things still aren’t working, so I have no idea how many other
obstacles are in my way to being back up and running. Here is the evidence I’ve gathered so far:</p>
<ul class="simple">
<li>In /var/log/syslog, there was an error about the security level setting for running external scripts. Adding the line
“script-security 3” before calling any scripts made that go away and allowed OpenVPN to successfully start up. The
script I’m running is up.sh as described in the <a class="reference external" href="https://help.ubuntu.com/12.04/serverguide/openvpn.html">OpenVPN
tutorial</a> on the Ubuntu help pages, under the section “Prepare
server config for bridging”.</li>
<li>Initially after the release upgrade, the primary connection, eth0, no longer had any access to the outside world. I
could ping the router, but nothing outside the local network. I found that setting the tap0 device to down and
changing eth0 from static to dhcp seemed to fix this. Unfortunately, later something reverted back and the server no
longer has outside access again. I tried the tricks I used before and even tried stopping OpenVPN with
‘/etc/init.d/openvpn stop’ with no success, even after restarting networking and rebooting the server.</li>
<li>Even when the server could access external addresses things didn’t seem to be routing packets correctly. I found that
by disabling the br0, eth1, or tap0 (I can’t remember…), web pages loaded faster and everything seemed to work
properly. Running ‘route -vn’ was what gave me the idea in the first place because there multiple devices specified as
the outgoing for the same destination range. Unfortunately I didn’t memorize the details and things aren’t at the
point they were previously to try and figure it out.</li>
</ul>
<p>I’m sure there are some specifics of how OpenVPN works that would help me troubleshoot this, but my struggle with
problems like this (which seem to present themselves more often in Linux because I’m doing more advanced things) is
always trying to balance understanding the details of whatever I’m working with and just getting the dumb thing to work
because I need it done last week or last month…</p>
<p>Hopefully I’ll get to the bottom of all this and I’ll be able to report my findings soon. In the mean time, take a
lesson from my book, and be a little more cautious than I was with updating to the latest release.</p>
</div>


           </div>
           
          </div>
          <p><i>Original version published at <a href="https://mikemabey.blogspot.com/2012/05/troubles-with-openvpn-in-ubuntu-1204.html">https://mikemabey.blogspot.com/2012/05/troubles-with-openvpn-in-ubuntu-1204.html</a></i></p>
  <span style="font-size: 14px;"><b>Tags: </b><a class="tag_link">Linux</a>,<a class="tag_link"> Linux administration</a>,<a class="tag_link"> networking</a>,<a class="tag_link"> OpenVPN</a>,<a class="tag_link"> Precise Pangolin</a>,<a class="tag_link"> Ubuntu</a>,<a class="tag_link"> Ubuntu 12.04</a>,<a class="tag_link"> VPN</a>,<a class="tag_link"> Wireshark</a>,
  </span>
  <script>convert_tag_links();</script>
<div style="float: right;"><a href="/blog/">Back to Blog Index</a></div><br />
<script> filter_tags(); </script>
<footer>

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2015-2019, Mike Mabey.
      Last updated on January 16, 2019.
    </p>
  </div>

  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.

</footer>
        </div>
      </div>

    </section>

  </div>
  


  

    
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../../_static/doctools.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    

  

  <script type="text/javascript" src="../../../_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>