

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Goodbye Blogger! &mdash; Mike Mabey</title>
  

  
  
    <link rel="shortcut icon" href="../../../_static/favicon.ico"/>
  
  
  

  

  
  
    
      <link rel="search" type="application/opensearchdescription+xml"
            title="Search within Mike Mabey"
            href="../../../_static/opensearch.xml"/>
    

  

  <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/custom.css" type="text/css" />
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="2016" href="../../2016/index.html" />
    <link rel="prev" title="How eCryptfs Affects Filename Lengths" href="../08/ecryptfs_filenames.html" />

  <link href='https://fonts.googleapis.com/css?family=Lato:400,700,400italic,700italic|Roboto+Slab:400,700|Inconsolata:400,700&subset=latin,cyrillic' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" type="text/css" href="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.0.3/cookieconsent.min.css" />
  <script src="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.0.3/cookieconsent.min.js"></script>
  <script>
      window.addEventListener("load", function(){
          window.cookieconsent.initialise({
              "palette": {
                  "popup": { "background": "#343131" },
                  "button": { "background": "#2980b9" }
              },
              "theme": "classic", "position": "bottom-right",
              "content": { "message": "This website uses cookies." }
          })});
  </script>

  <script src="../../../_static/tag_toggle.js" ></script>

  <!-- Structured article data -->
  <script type="application/ld+json">
    {
      "@context": "http://schema.org",
      "@type": "BlogPosting",
      "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "https://mikemabey.com/blog/2017/06/goodbye_blogger.html"
      },
      "headline": "Goodbye Blogger!",
      "description": "In this post, I describe how I moved my blog off Blogger and onto my own website.",
      "author": {
        "@type": "Person",
        "name": "Mike Mabey"
      },
      "datePublished": "2017-06-03T00:00:00",
      "dateModified": "2017-07-18T00:00:00",
      "publisher": {
        "@type": "Organization",
        "name": "mikemabey.com",
        "logo": {
          "@type": "ImageObject",
          "url": "https://mikemabey.com/logo.png",
          "width": 395,
          "height": 60
        }
      }
    }
  </script>

  <!-- Structured breadcrumb data for the blog -->
  <script type="application/ld+json">
  {
    "@context": "http://schema.org",
    "@type": "BreadcrumbList",
    "itemListElement": [{
      "@type": "ListItem",
      "position": 1,
      "item": {
        "@id": "https://mikemabey.com/blog",
        "name": "Blog"
      }
    },{
      "@type": "ListItem",
      "position": 2,
      "item": {
        "@id": "https://mikemabey.com/blog/2017",
        "name": "2017"
      }
    },{
      "@type": "ListItem",
      "position": 3,
      "item": {
        "@id": "https://mikemabey.com/blog/2017/06/goodbye_blogger.html",
        "name": "Goodbye Blogger!"
      }
    }]
  }
  </script>

  <!-- Structured social profile links -->
  <script type="application/ld+json">
  {
    "@context": "http://schema.org",
    "@type": "Person",
    "name": "Mike Mabey",
    "url": "https://mikemabey.com",
    "sameAs": [
      "https://plus.google.com/+MikeMabey",
      "https://twitter.com/mkmabey",
      "https://www.linkedin.com/pub/michael-mabey/18/a24/a6b/en"
    ]
  }
  </script>

  <!-- Search helper for Google -->
  <script type="application/ld+json">
  {
    "@context": "http://schema.org",
    "@type": "WebSite",
    "url": "https://mikemabey.com/",
    "potentialAction": {
      "@type": "SearchAction",
      "target": "https://mikemabey.com/search.html?q={search_term_string}",
      "query-input": "required name=search_term_string"
    }
  }
  </script>



  
  <script src="../../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

  

  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-59535121-1', 'auto');
    ga('send', 'pageview');

  </script>


  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../../index.html" class="icon icon-home"> Mike Mabey
          

          
          </a>

          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search site" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../index.html">Home</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../classes.html">Classes</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../cse469s19/index.html">CSE 469 Spring 2019</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../cse469s19/index.html">Course Home Page</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../cse469s19/syllabus.html">Syllabus</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../cse469s19/assignments.html">Assignments</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../cse469s19/paper_report.html">Paper Report</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../cse469s19/project.html">Group Project</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../pubs.html">Publications</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../service.html">Service</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../teaching.html">Teaching Experience</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../web.html">Around the Web</a><ul>
<li class="toctree-l2"><a class="reference external" href="https://bitbucket.org/mmabey/">Bitbucket</a></li>
<li class="toctree-l2"><a class="reference external" href="https://github.com/mmabey">GitHub</a></li>
<li class="toctree-l2"><a class="reference external" href="https://pypi.org/user/mmabey/">PyPI</a></li>
<li class="toctree-l2"><a class="reference external" href="https://blog.mikemabey.com">Blog</a></li>
<li class="toctree-l2"><a class="reference external" href="https://twitter.com/mkmabey">Twitter</a></li>
<li class="toctree-l2"><a class="reference external" href="https://www.linkedin.com/pub/michael-mabey/18/a24/a6b/en">LinkedIn</a></li>
<li class="toctree-l2"><a class="reference external" href="http://scholar.google.com/citations?user=kSpLEdsAAAAJ&amp;hl=en">Google Scholar</a></li>
<li class="toctree-l2"><a class="reference external" href="http://sefcom.asu.edu/">SEFCOM Research Lab</a></li>
<li class="toctree-l2"><a class="reference external" href="https://webapp4.asu.edu/directory/person/1353747">ASU Profile</a></li>
<li class="toctree-l2"><a class="reference external" href="https://prezi.com/user/mikemabey/">Prezi</a></li>
<li class="toctree-l2"><a class="reference external" href="http://alternativeto.net/user/mikemabey/">AlternativeTo</a></li>
<li class="toctree-l2"><a class="reference external" href="https://readthedocs.org/profiles/mmabey/">Read the Docs</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="../../index.html">Blog</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../index.html">2017 Entries</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../08/ecryptfs_filenames.html">How eCryptfs Affects Filename Lengths</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Goodbye Blogger!</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../2016/index.html">2016 Entries</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../2016/03/using_git_stash_staged_changes.html">Using git-stash without losing staged changes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../2016/02/check_out_old_chromium.html">How to check out an old version of Chromium OS</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../2016/01/n_dimensional_latex.html">Getting “n-dimensional” to look right in LaTeX</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../2015/index.html">2015 Entries</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../2015/01/fixing_repo_init_chromium_os.html">Fixing repo init to check out Chromium OS code</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../2013/index.html">2013 Entries</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../2013/10/last_straw_for_excel.html">The Last Straw for Excel?</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../2013/05/getting_into_developer_mode.html">Getting into Developer Mode on the HP Pavilion 14 Chromebook</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../2012/index.html">2012 Entries</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../2012/11/downgraded_to_python_2.7.1.html">Downgraded to Python 2.7.1? How did that happen?</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../2012/08/the_internet_is_so_awesome.html">The Internet is so awesome (in case you didn’t already know)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../2012/06/debian_on_android.html">Debian on Android and my quest for a full-fledged terminal Python IDE</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../2012/06/openvpn-update-fixed.html">OpenVPN Update: Fixed!</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../2012/06/pydroid_at_last.html">Pydroid at last!</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../2012/05/troubles_with_openvpn.html">Troubles with OpenVPN in Ubuntu 12.04</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../2012/05/risk_intelligence.html">Risk Intelligence: Get better at seeing the future without the two Strawberry Nirvanas</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../2012/05/first_post.html">First Post</a></li>
</ul>
</li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
      &nbsp;
      <div class="served_by">Served with<br />
        <a href="https://pages.github.com/"><img src="/_static/gh_pages.svg"/></a>
        <a href="https://www.cloudflare.com/"><img src="/_static/cf.png"/></a>
        <div style="display: none;">

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">Mike Mabey</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          <h1 style="margin-bottom: 3px;">/var/log/mike</h1>
<h2 style="margin-bottom: 3px;"><em>Mike’s Blog</em></h2>
<hr style="margin-bottom: 7px; margin-top: 3px;"/>
<div style="float: right;"><a href="/blog/">Back to Blog Index</a></div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="goodbye-blogger">
<span id="goodbye-blogger"></span><h1>Goodbye Blogger!<a class="headerlink" href="#goodbye-blogger" title="Permalink to this headline">¶</a></h1>
<p>Blogger has been good to me over the years. I set up my first blog on Blogger before I had any other digital real estate
to speak of. But ever since setting up <a class="reference external" href="https://mikemabey.com">mikemabey.com</a>, I’ve been looking for a way to migrate
off of Blogger and have everything all together on the same site. I recently completed that objective, and in this post
I’ll share how I did it and what obstacles I encountered along the way.</p>
<p>Naturally, this is the final post I’ll share on Blogger. Future blog entries will be available on the
<a class="reference external" href="https://blog.mikemabey.com">blog</a> section of <a class="reference external" href="https://mikemabey.com">my website</a>.</p>
<div class="section" id="tl-dr">
<span id="tl-dr"></span><h2>TL;DR<a class="headerlink" href="#tl-dr" title="Permalink to this headline">¶</a></h2>
<p>I write posts in <a class="reference external" href="https://daringfireball.net/projects/markdown/">Markdown</a>, which are processed by
<a class="reference external" href="http://www.sphinx-doc.org/">Sphinx</a> which <a class="reference external" href="http://www.sphinx-doc.org/en/stable/markdown.html">supports Markdown</a> via
<a class="reference external" href="http://recommonmark.readthedocs.io/en/latest/index.html">recommonmark</a>. I emulate support for tags using some custom
JavaScript and CSS, and I generate an index of entries with a Python script.</p>
</div>
<div class="section" id="background">
<span id="background"></span><h2>Background<a class="headerlink" href="#background" title="Permalink to this headline">¶</a></h2>
<p>The source of my website is written in <a class="reference external" href="http://docutils.sourceforge.net/docs/user/rst/quickref.html">reStructuredText</a>
(RST), a markup language favored by Python programmers in their documentation. I compile the source using
<a class="reference external" href="http://www.sphinx-doc.org/">Sphinx</a>, a documentation generation tool that can render RST into many formats, including
HTML, PDF, LaTeX, etc.</p>
<p>Sphinx uses <a class="reference external" href="http://jinja.pocoo.org/">Jinja</a> templates to make everything more modular and customizable. You configure
the template for your docs, then Sphinx takes the relatively simple body of a document and renders it using the
template. It’s pretty slick.</p>
</div>
<div class="section" id="objectives">
<span id="objectives"></span><h2>Objectives<a class="headerlink" href="#objectives" title="Permalink to this headline">¶</a></h2>
<p>When migrating to my own site, I wanted to retain the following features from Blogger:</p>
<ul class="simple">
<li>Tags: On Blogger, each entry can have some tags indicating topics covered by the post. You can also filter posts by
these tags to see other posts on the same topic.</li>
<li>Search: Blogger has a search function available to users.</li>
<li>Analytics: Blogger provides statistics on which pages have been visited how many times. It has been fun to watch a
few of my posts reach certain page view milestones.</li>
</ul>
<p>In addition to the above, I also wanted to add the following new features:</p>
<ul class="simple">
<li>Markdown: The idea of writing posts in Markdown really appeals to me. Of course, plain text files make it easy to
maintain and keep track of using <a class="reference external" href="https://git-scm.com/">git</a>. It also lowers the barrier to writing new posts due to
its simplicity and because I don’t have to have web access.</li>
<li>Web Hook: By changing my publication flow to incorporate git, it makes a lot of sense to incorporate web hooks to
automatically update content on my site when I push new commits and thereby eliminate the need for FTP.</li>
</ul>
</div>
<div class="section" id="first-attempt">
<span id="first-attempt"></span><h2>First Attempt<a class="headerlink" href="#first-attempt" title="Permalink to this headline">¶</a></h2>
<p>Some of the objectives I listed above were actually inspired by the feature set of <a class="reference external" href="https://caddyserver.com/">Caddy</a>,
the first web server ever to provide automatic HTTPS <em>by default</em>. Caddy also supports rendering
<a class="reference external" href="https://caddyserver.com/docs/markdown">Markup</a> as HTML on demand as well as <a class="reference external" href="https://caddyserver.com/docs/http.git">git
integration</a>.</p>
<div class="section" id="markdown">
<span id="markdown"></span><h3>Markdown<a class="headerlink" href="#markdown" title="Permalink to this headline">¶</a></h3>
<p>Caddy’s Markdown support is pretty cool. You can create a template using syntax defined in Go’s
<a class="reference external" href="http://golang.org/pkg/text/template/">text/template</a> package, which isn’t that dissimilar to
<a class="reference external" href="http://jinja.pocoo.org/">Jinja</a> syntax. I attempted using this by first rendering a very simple RST document to HTML,
then adding the template parameters to the HTML file where I needed Caddy to fill in some details, and used this as the
template for blog entries.</p>
<p>For the most part, this worked pretty well. Using JSON-formatted <a class="reference external" href="https://caddyserver.com/docs/markdown">Front Matter</a>,
I could specify certain metadata about each post, such as the date of the post, a link to the original post on Blogger,
and so forth. However, Sphinx was unable to add any of the posts to the site index (for search purposes) because all the
posts were being rendered outside the scope of what Sphinx knew about. I attempted some workarounds, but this was a deal
breaker for me in the end.</p>
</div>
<div class="section" id="git-integration">
<span id="git-integration"></span><h3>Git Integration<a class="headerlink" href="#git-integration" title="Permalink to this headline">¶</a></h3>
<p>Caddy allows you to specify a git repository for it to pull from to build your website. This plugin is pretty
feature-rich and includes support for specifying the following:</p>
<ul class="simple">
<li>Deployment SSH key for accessing a private git repository</li>
<li>An interval at which it should automatically pull any new changes</li>
<li>Commands to be executed after a successful pull</li>
<li><a class="reference external" href="https://caddyserver.com/docs/http.git">More</a>…</li>
</ul>
<p>One thing I found that helped when using this Caddy plugin was to have two separate versions of my
<a class="reference external" href="https://caddyserver.com/docs/caddyfile">Caddyfile</a>, one for development that is tracked by git along with the other
source files for the website, and another for production that I created as a <a class="reference external" href="https://gist.github.com/">gist</a> on GitHub.
To illustrate why this was helpful, here is the development configuration:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">mikemabey</span><span class="o">.</span><span class="n">com</span><span class="p">:</span><span class="mi">8080</span> <span class="p">{</span>
  <span class="n">root</span> <span class="n">_build</span><span class="o">/</span><span class="n">html</span>
  <span class="n">log</span> <span class="n">stdout</span>
  <span class="n">errors</span> <span class="n">stderr</span>
<span class="p">}</span>

<span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">blog</span><span class="o">.</span><span class="n">mikemabey</span><span class="o">.</span><span class="n">com</span><span class="p">:</span><span class="mi">8080</span> <span class="p">{</span>
  <span class="n">redir</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">mikemabey</span><span class="o">.</span><span class="n">com</span><span class="p">:</span><span class="mi">8080</span><span class="o">/</span><span class="n">blog</span><span class="o">/</span>
<span class="p">}</span>
</pre></div>
</div>
<p>And this is my production configuration:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">mikemabey</span><span class="o">.</span><span class="n">com</span> <span class="p">{</span>
  <span class="n">root</span> <span class="o">/</span><span class="n">mnt</span><span class="o">/</span><span class="n">web_data</span><span class="o">/</span><span class="n">caddy_www</span><span class="o">/</span><span class="n">_build</span><span class="o">/</span><span class="n">html</span>
  <span class="n">git</span> <span class="n">git</span><span class="nd">@bitbucket</span><span class="o">.</span><span class="n">org</span><span class="p">:</span><span class="n">mmabey</span><span class="o">/</span><span class="n">my_website</span> <span class="p">{</span>
    <span class="n">branch</span> <span class="n">master</span>
    <span class="n">path</span> <span class="o">/</span><span class="n">mnt</span><span class="o">/</span><span class="n">web_data</span><span class="o">/</span><span class="n">caddy_www</span>
    <span class="n">key</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">ubuntu</span><span class="o">/.</span><span class="n">ssh</span><span class="o">/</span><span class="n">id_rsa</span>
    <span class="n">hook</span> <span class="o">/</span><span class="n">webhook</span>
    <span class="n">hook_type</span> <span class="n">bitbucket</span>
    <span class="n">then</span> <span class="o">/</span><span class="n">mnt</span><span class="o">/</span><span class="n">web_data</span><span class="o">/</span><span class="n">caddy_www</span><span class="o">/</span><span class="n">run_make</span><span class="o">.</span><span class="n">sh</span>
  <span class="p">}</span>
  <span class="n">realip</span> <span class="p">{</span>
    <span class="kn">from</span> <span class="mf">10.90</span><span class="o">.</span><span class="mf">0.0</span><span class="o">/</span><span class="mi">16</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">blog</span><span class="o">.</span><span class="n">mikemabey</span><span class="o">.</span><span class="n">com</span> <span class="p">{</span>
  <span class="n">redir</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">mikemabey</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">blog</span><span class="o">/</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Here are the key differences:</p>
<ul class="simple">
<li>When developing, I want to use port 8080</li>
<li>I build the files myself when developing, but production should build itself</li>
<li>No need to hook into the git repo on my dev machine</li>
<li>I have different logging and error reporting needs when developing vs when in production</li>
</ul>
<p>By the way, if you’re wondering why my production configuration explicitly uses HTTP when I was touting the automatic
HTTPS feature of Caddy, it’s because my website sits behind a <a class="reference external" href="https://caddyserver.com/docs/proxy">proxy</a> (also running
Caddy) that handles the HTTPS certificates on my behalf.</p>
<p><strong>Edit</strong> <em>(7/18/2017)</em>: If you happen to be running your web server behind a <a class="reference external" href="https://caddyserver.com/docs/proxy">reverse
proxy</a>, you should note that the <a class="reference external" href="https://caddyserver.com/docs/http.git">git plugin</a>
verifies that each webhook request is actually coming from the expected service (e.g. GitHub, Bitbucket) or it will
return a <code class="docutils literal notranslate"><span class="pre">403</span> <span class="pre">Forbidden</span></code> error. The problem is, as described in <a class="reference external" href="https://caddy.community/t/best-practise-for-multiple-tenant-multiple-https-domain-server/2082/6">this forum
discussion</a>, that the
proxy moves the actual remote IP address to a <code class="docutils literal notranslate"><span class="pre">X-Forwarded-For</span></code> header, resulting in a failed source validation. The
workaround is to add the <code class="docutils literal notranslate"><span class="pre">realip</span></code> directive to the Caddyfile as I have above, with the <code class="docutils literal notranslate"><span class="pre">from</span></code> field set to the internal
IP address of the reverse proxy server. This will restore “the real IP information when running caddy behind a proxy,”
as the <a class="reference external" href="https://github.com/captncraig/caddy-realip/blob/master/README.md">plugin documentation</a> explains. Just don’t
forget to add the <code class="docutils literal notranslate"><span class="pre">http.realip</span></code> plugin when you download Caddy!</p>
</div>
</div>
<div class="section" id="final-setup">
<span id="final-setup"></span><h2>Final Setup<a class="headerlink" href="#final-setup" title="Permalink to this headline">¶</a></h2>
<p>As it turns out, in addition to Sphinx supporting source files in RST, it also supports
<a class="reference external" href="http://www.sphinx-doc.org/en/stable/markdown.html">Markdown</a>, and it’s surprisingly simple to set up. The
<a class="reference external" href="http://recommonmark.readthedocs.io/en/latest/index.html">recommonmark</a> library, which Sphinx uses to render files to
HTML, even allows you to include portions of RST code that <em>get evaluated</em> by Sphinx before it compiles it to HTML (this
is made possible by an add-on <a class="reference external" href="http://recommonmark.readthedocs.io/en/latest/auto_structify.html">component</a> that you
have to configure before using).</p>
<div class="section" id="tags">
<span id="tags"></span><h3>Tags<a class="headerlink" href="#tags" title="Permalink to this headline">¶</a></h3>
<p>That last bit about adding RST snippets is actually super cool. What it really means is that if there is a RST command
that doesn’t exist in Markdown, you can use this add-on so that you can still use that syntax in your Markdown file.
When I combined this feature with Sphinx’s <a class="reference external" href="http://www.sphinx-doc.org/en/stable/markup/misc.html#file-wide-metadata">file-wide
metadata</a> markup, all I have to do is add a
little RST section at the top of each Markdown file to be able to specify the metadata for that post, like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>```eval_rst
:heading: /var/log/mike
:subheading: Mike&#39;s Blog
:doc_type: blog

:tags: blog, Blogger, Markdown, Sphinx, git, website, mikemabey.com, Jinja, reStructuredText, Caddy, HTTPS, gist
:day: 3
:month: 6
:year: 2017
```
</pre></div>
</div>
<p>Notice the <code class="docutils literal notranslate"><span class="pre">:tags:</span></code> line. It’s a comma-separated list that has to be all on the same line for Sphinx to assign it all to
the <code class="docutils literal notranslate"><span class="pre">:tags:</span></code> meta variable. I’ll explain how I use these when I talk about the Blog Index.</p>
</div>
<div class="section" id="search">
<span id="search"></span><h3>Search<a class="headerlink" href="#search" title="Permalink to this headline">¶</a></h3>
<p>Sphinx has a built-in search feature, which indexes the contents of all the source files during compilation and saves
the information to a static file. What all this means is that you get a searching feature for free without having to
give up running only static files on your site. By adding Markdown to the set of file types that Sphinx compiles to
HTML, I didn’t have to do anything else to achieve this objective.</p>
</div>
<div class="section" id="analytics">
<span id="analytics"></span><h3>Analytics<a class="headerlink" href="#analytics" title="Permalink to this headline">¶</a></h3>
<p>When I set up <a class="reference external" href="https://mikemabey.com">mikemabey.com</a>, I added <a class="reference external" href="https://analytics.google.com">Google Analytics</a> to get an
idea of what traffic was coming to the site. Analytics generates a Pages Report automatically, giving details about each
page on the site. While it’s not the same format as Blogger, it still provides the basic information I was looking for
to achieve this objective, so this wasn’t any extra work for me.</p>
</div>
<div class="section" id="blog-index">
<span id="blog-index"></span><h3>Blog Index<a class="headerlink" href="#blog-index" title="Permalink to this headline">¶</a></h3>
<p>Including an index of all blog entries was the trickiest objective to achieve. Although it’s easy to have Sphinx
generate a simple <a class="reference external" href="http://www.sphinx-doc.org/en/stable/markup/toctree.html">table of contents</a> in such a way as to list
all the blog entries, doing things this way doesn’t give you any control over how everything is displayed. The
objectives of my blog index were:</p>
<ul class="simple">
<li>Group entries by year, with each year being its own unordered list, and with everything in reverse chronological order</li>
<li>Embed the entry’s tags into each list item somehow to be able to selectively show them</li>
</ul>
<p>The feature of Markdown that made all this possible was that you can include arbitrary HTML (with some limitations) and
it will all render properly. I leveraged this by creating an index in Markdown with all the custom HTML I needed while
not getting in Sphinx’s way of generating the HTML that surrounds the article contents. This index file is regenerated
every time I compile to HTML by way of a Python script that the
<a class="reference external" href="http://www.sphinx-doc.org/en/stable/invocation.html">Makefile</a> runs before telling Sphinx to do its thing.</p>
<p>The individual entries use <code class="docutils literal notranslate"><span class="pre">&lt;li&gt;</span></code> tags that belong to CSS classes that correspond with the tags for that entry. For
example:</p>
<div class="highlight-html notranslate"><div class="highlight"><pre><span></span><span class="p">&lt;</span><span class="nt">li</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;entry hidden_entry Chrome_OS Chromium Chromium_OS Linux_Mint Ubuntu 2015&quot;</span><span class="p">&gt;</span> Jan 30: <span class="p">&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;/blog/2015/01/fixing_repo_init_chromium_os.html&quot;</span><span class="p">&gt;</span>Fixing repo init to check out Chromium OS code<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
</pre></div>
</div>
<p>This entry is part of the following classes:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">entry</span></code>: All entries and year headers (which use a <code class="docutils literal notranslate"><span class="pre">&lt;h2&gt;</span></code> tag) use this class so I can easily get a handle on
everything related to blog entries.</li>
<li><code class="docutils literal notranslate"><span class="pre">hidden_entry</span></code>: This is an aesthetic tweak. By trying out a few different techniques, I discovered that it looks
better in the general case if all entries are hidden when the page first loads and then the selected tags have this
class removed (making them appear), than to do this in the opposite order.</li>
<li><code class="docutils literal notranslate"><span class="pre">2015</span></code>: The year the post was created, allowing me to show entries by year.</li>
<li>The other classes correspond with the tags for that entry.</li>
</ul>
<p>I then have a custom set of CSS rules that handle the styling and turning on/off the display for tags, triggered by some
JavaScript. The filtering is set when the URL has the query parameter <code class="docutils literal notranslate"><span class="pre">?tag=some_tag</span></code>, and each blog entry’s page has
a section at the bottom with links to the appropriate URLs that include this query.</p>
</div>
<div class="section" id="year-indexes">
<span id="year-indexes"></span><h3>Year Indexes<a class="headerlink" href="#year-indexes" title="Permalink to this headline">¶</a></h3>
<p>The final piece of the puzzle was including a way to quickly jump to entries from a specific year. I wanted this to
appear in the main table of contents on the left panel, which meant working within the capabilities of Sphinx’s <a class="reference external" href="http://www.sphinx-doc.org/en/stable/markup/toctree.html">table
of contents</a> feature.</p>
<p>First, I modified my Python script that generates the blog index to add the following:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>```eval_rst
.. toctree::
   :hidden:
   :maxdepth: 1

   2017 Entries &lt;2017/index&gt;
   2016 Entries &lt;2016/index&gt;
   2015 Entries &lt;2015/index&gt;
   2013 Entries &lt;2013/index&gt;
   2012 Entries &lt;2012/index&gt;
```
</pre></div>
</div>
<p>Of course, this once again leverages <a class="reference external" href="http://recommonmark.readthedocs.io/en/latest/auto_structify.html"><code class="docutils literal notranslate"><span class="pre">recommonmark</span></code>’s
add-on</a> that evaluates RST code. Here’s what each part
means:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">:hidden:</span></code> - The table of contents tree won’t appear in the rendered document, but will tell Sphinx about the
hierarchy of pages.</li>
<li><code class="docutils literal notranslate"><span class="pre">:maxdepth:</span> <span class="pre">1</span></code> - Don’t recurse into the directories.</li>
<li><code class="docutils literal notranslate"><span class="pre">2017</span> <span class="pre">Entries</span> <span class="pre">&lt;2017/index&gt;</span></code> - Points to a file named <code class="docutils literal notranslate"><span class="pre">index.rst</span></code> in the year directory and labels it “2017 Entries”</li>
</ul>
<p>The Python script also creates a file called <code class="docutils literal notranslate"><span class="pre">index.rst</span></code> in each of the year directories with contents similar to the
following:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">====</span>
<span class="mi">2017</span>
<span class="o">====</span>
<span class="o">|</span><span class="n">redir</span><span class="o">|</span>

<span class="o">..</span> <span class="o">|</span><span class="n">redir</span><span class="o">|</span> <span class="n">raw</span><span class="p">::</span> <span class="n">html</span>

   <span class="o">&lt;</span><span class="n">script</span> <span class="n">language</span><span class="o">=</span><span class="s2">&quot;javascript&quot;</span><span class="o">&gt;</span><span class="n">window</span><span class="o">.</span><span class="n">location</span><span class="o">.</span><span class="n">href</span> <span class="o">=</span> <span class="s2">&quot;/blog/?tag=2017&quot;</span><span class="o">&lt;/</span><span class="n">script</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>This creates some raw HTML that redirects the browser back go the blog index with a query parameter specifying a
particular year.</p>
</div>
</div>
<div class="section" id="final-thoughts">
<span id="final-thoughts"></span><h2>Final Thoughts<a class="headerlink" href="#final-thoughts" title="Permalink to this headline">¶</a></h2>
<p>I’m really happy with the results of this transition, even though it took a while for me to figure out how to achieve
all of my objectives. If you’re looking for a way to add Markdown files to your Sphinx-generated site, hopefully you’ll
find some of the things I’ve discussed to be helpful. And give <a class="reference external" href="https://caddyserver.com/">Caddy</a> try sometime, it’s a
great web server!</p>
</div>
</div>


           </div>
           
          </div>
          <p><i>Original version published at <a href="http://mikemabey.blogspot.com/2017/06/goodbye-blogger.html">http://mikemabey.blogspot.com/2017/06/goodbye-blogger.html</a></i></p>
  <span style="font-size: 14px;"><b>Tags: </b><a class="tag_link">blog</a>,<a class="tag_link"> Blogger</a>,<a class="tag_link"> Markdown</a>,<a class="tag_link"> Sphinx</a>,<a class="tag_link"> git</a>,<a class="tag_link"> website</a>,<a class="tag_link"> mikemabey.com</a>,<a class="tag_link"> Jinja</a>,<a class="tag_link"> reStructuredText</a>,<a class="tag_link"> RST</a>,<a class="tag_link"> Caddy</a>,<a class="tag_link"> HTTPS</a>,<a class="tag_link"> gist</a>,
  </span>
  <script>convert_tag_links();</script>
<div style="float: right;"><a href="/blog/">Back to Blog Index</a></div><br />
<script> filter_tags(); </script>
<footer>

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2015-2019, Mike Mabey.
      Last updated on January 09, 2019.
    </p>
  </div>

  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.

</footer>
        </div>
      </div>

    </section>

  </div>
  


  

    
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../../_static/doctools.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    

  

  <script type="text/javascript" src="../../../_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>